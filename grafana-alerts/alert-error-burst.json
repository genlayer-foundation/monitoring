{
  "annotations": {
    "baseline_errors": "{{ $values.BaselineErrors.Value }} errors (2 hours ago)",
    "current_errors": "{{ $values.CurrentErrors.Value }} errors in last 10 minutes",
    "description": "Error count is {{ $values.CurrentErrors.Value }}, which is 10x higher than baseline ({{ $values.BaselineErrors.Value }} errors 2 hours ago). This indicates a significant error spike.\n\nAffected validator: {{ $labels.validator_name }}",
    "summary": "Error burst detected: {{ $values.CurrentErrors.Value }} errors on {{ $labels.validator_name }} (baseline: {{ $values.BaselineErrors.Value }})"
  },
  "condition": "Threshold",
  "data": [
    {
      "datasourceUid": "grafanacloud-logs",
      "model": {
        "expr": "sum by(validator_name) (count_over_time({validator_name=~\".+\"} |~ \"(?i)(error|exception|panic|fatal)\" [10m]))",
        "intervalMs": 1000,
        "legendFormat": "{{ validator_name }} current errors",
        "maxDataPoints": 43200,
        "queryType": "instant",
        "refId": "CurrentErrors"
      },
      "queryType": "instant",
      "refId": "CurrentErrors",
      "relativeTimeRange": {
        "from": 600
      }
    },
    {
      "datasourceUid": "grafanacloud-logs",
      "model": {
        "expr": "sum by(validator_name) (count_over_time({validator_name=~\".+\"} |~ \"(?i)(error|exception|panic|fatal)\" [10m]))",
        "intervalMs": 1000,
        "legendFormat": "{{ validator_name }} baseline",
        "maxDataPoints": 43200,
        "queryType": "instant",
        "refId": "BaselineErrors"
      },
      "queryType": "instant",
      "refId": "BaselineErrors",
      "relativeTimeRange": {
        "from": 7800,
        "to": 7200
      }
    },
    {
      "datasourceUid": "__expr__",
      "model": {
        "expression": "$CurrentErrors > ($BaselineErrors * 10)",
        "intervalMs": 1000,
        "maxDataPoints": 43200,
        "refId": "Threshold",
        "type": "math"
      },
      "refId": "Threshold",
      "relativeTimeRange": {}
    }
  ],
  "execErrState": "Alerting",
  "folderUID": "dfa1v9yck3ny8b",
  "for": "2m0s",
  "id": 7,
  "labels": {
    "asimov-alert": "true",
    "component": "logs",
    "severity": "critical"
  },
  "noDataState": "OK",
  "orgID": 1,
  "provenance": "api",
  "ruleGroup": "Log Analysis Alerts",
  "title": "Error Burst Detected in Logs",
  "uid": "ffa5bs9e9mgw0d",
  "updated": "2026-01-14T16:55:25.630Z"
}
